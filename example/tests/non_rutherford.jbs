#!/usr/bin/env jabs
set ion 4He
set energy "3.035 MeV"
set emin "150 keV"
set fluence 5.4e12
set det theta "160 deg" solid 70msr calib slope 2.00keV offset 10keV reso 20keV
set det foil Si 150tfu
set alpha "0 deg"
set sample Au 32.5tfu rough 30tfu SiO2 6680tfu Si 20000tfu yield 0.96
load exp "rbs_114.dat"
#Adding reactions is optional. If no reactions are specified, RBS and ERD reactions are added automatically. Reactions that are not possible are not calculated!
add reactions RBS
#We can remove a specific reaction.
remove reaction RBS 16O
#We can add reactions with different built-in screening models and min/max energy can be specified. These parameters are optional. 
add reaction RBS 16O cs Andersen max "1.769 MeV"
#The file below contains an R33 file generated by sigmacalc http://sigmacalc.iate.obninsk.ru/
#The options are as: R33, keV, RTR, Tab, O-16, (alpha, alpha), scattering angle 160
load reaction "sigmacalc_16O_alpha_alpha_16O_160deg.r33"

#Accurate mode employs adaptive integration to achieve higher accuracy when cross sections have structure and when weighting of cross sections by straggling is important. Some other approximations are also neglected. Disadvantage: it's slow. Uncomment next line to enable.
#set sim accurate

simulate
add fit range [254:926] [1338:1424]

#We skip the fast fit phase, since the lower accuracy simulation is counterproductive */
set fit slow

fit *calib*,fluence,energy,yield3
save spectra "non_rutherford_out.csv"
show fit
